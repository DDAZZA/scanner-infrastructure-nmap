// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`nmap worker should run multiple scans when multiple targets are configured 1`] = `
Object {
  "raw": Array [
    "<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>
<!DOCTYPE nmaprun></nmaprun>",
    "<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>
<!DOCTYPE nmaprun></nmaprun>",
  ],
  "result": Array [
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 631,
        "protocol": "tcp",
        "scripts": null,
        "service": "ipp",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 631 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:631",
      "name": "ipp",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 7778,
        "protocol": "tcp",
        "scripts": null,
        "service": "interwise",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 7778 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:7778",
      "name": "interwise",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 8080,
        "protocol": "tcp",
        "scripts": null,
        "service": "http-proxy",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 8080 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:8080",
      "name": "http-proxy",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 9200,
        "protocol": "tcp",
        "scripts": null,
        "service": "wap-wsp",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 9200 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:9200",
      "name": "wap-wsp",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 631,
        "protocol": "tcp",
        "scripts": null,
        "service": "ipp",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 631 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:631",
      "name": "ipp",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 7778,
        "protocol": "tcp",
        "scripts": null,
        "service": "interwise",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 7778 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:7778",
      "name": "interwise",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 8080,
        "protocol": "tcp",
        "scripts": null,
        "service": "http-proxy",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 8080 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:8080",
      "name": "http-proxy",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 9200,
        "protocol": "tcp",
        "scripts": null,
        "service": "wap-wsp",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 9200 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:9200",
      "name": "wap-wsp",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
  ],
}
`;

exports[`nmap worker should take parameters 1`] = `
Object {
  "raw": Array [
    "<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>
<!DOCTYPE nmaprun></nmaprun>",
  ],
  "result": Array [
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 631,
        "protocol": "tcp",
        "scripts": null,
        "service": "ipp",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 631 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:631",
      "name": "ipp",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 7778,
        "protocol": "tcp",
        "scripts": null,
        "service": "interwise",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 7778 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:7778",
      "name": "interwise",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 8080,
        "protocol": "tcp",
        "scripts": null,
        "service": "http-proxy",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 8080 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:8080",
      "name": "http-proxy",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 9200,
        "protocol": "tcp",
        "scripts": null,
        "service": "wap-wsp",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 9200 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:9200",
      "name": "wap-wsp",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
  ],
}
`;

exports[`nmap worker should throw an error if a scan fails 1`] = `"Failed to execute nmap portscan."`;

exports[`nmap worker should work with a single target 1`] = `
Object {
  "raw": Array [
    "<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>
<!DOCTYPE nmaprun></nmaprun>",
  ],
  "result": Array [
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 631,
        "protocol": "tcp",
        "scripts": null,
        "service": "ipp",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 631 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:631",
      "name": "ipp",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 7778,
        "protocol": "tcp",
        "scripts": null,
        "service": "interwise",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 7778 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:7778",
      "name": "interwise",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 8080,
        "protocol": "tcp",
        "scripts": null,
        "service": "http-proxy",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 8080 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:8080",
      "name": "http-proxy",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
    Object {
      "attributes": Object {
        "hostname": "localhost",
        "ip_address": "127.0.0.1",
        "mac_address": null,
        "method": "table",
        "operating_system": null,
        "port": 9200,
        "protocol": "tcp",
        "scripts": null,
        "service": "wap-wsp",
        "state": "open",
      },
      "category": "Open Port",
      "description": "Port 9200 is open using tcp protocol.",
      "id": "49bf7fd3-8512-4d73-a28f-608e493cd726",
      "location": "tcp://127.0.0.1:9200",
      "name": "wap-wsp",
      "osi_layer": "NETWORK",
      "severity": "INFORMATIONAL",
    },
  ],
}
`;
